(function(t){function e(e){for(var a,i,n=e[0],l=e[1],c=e[2],u=0,m=[];u<n.length;u++)i=n[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(m.length)m.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,n=1;n<s.length;n++){var l=s[n];0!==o[l]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=s[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0b6f":function(t,e,s){"use strict";var a=s("2e86"),o=s.n(a);o.a},"2e86":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"navs"}},[s("nav-bar"),s("info"),t.isRouterAlive?s("router-view"):t._e()],1)},r=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"navBar"}},[s("nav",{staticClass:"navbar navbar-expand-sm navbar-dark bg-success mb-3"},[s("div",{staticClass:"container"},[s("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v("TodoMVC")]),t._m(0),s("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarNav"}},[s("ul",{staticClass:"navbar-nav"},[s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:"/about"}},[t._v("About")])],1)]),s("ul",{staticClass:"navbar-nav ml-auto"},[t.isLogin?s("li",{staticClass:"nav-item dropdown"},[s("a",{staticClass:"nav-link",attrs:{href:"#","data-toggle":"dropdown",id:"navbarDropdownMenuLink"}},[t._v("欢迎 "+t._s(t.userName))])]):t._e(),t.isLogin?s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(e){return t.logout()}}},[t._v("退出")])]):t._e(),t.isLogin?t._e():s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:"/users/login"}},[t._v("登录")])],1),t.isLogin?t._e():s("li",{staticClass:"nav-item"},[s("router-link",{staticClass:"nav-link",attrs:{to:"/users/register"}},[t._v("注册")])],1)])])],1)])])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"}},[s("span",{staticClass:"navbar-toggler-icon"})])}],l={name:"navBar",data:function(){return{}},mounted:function(){console.log("dahj",JSON.parse(sessionStorage.getItem("userInof")))},computed:{isLogin:function(){var t=!!this.$store.state.userId;return t&&(this.userName=this.$store.state.userName),t}},methods:{logout:function(){var t=this;this.axios.get("/api/users/logout").then((function(e){"OK"===e.statusText&&(t.$store.state.success_msg=e.data,sessionStorage.clear(),t.$store.state.loginState=!1,t.$store.state.userId=JSON.parse(sessionStorage.getItem("userInfo")),t.$router.push("/users/login"))}))}}},c=l,d=s("2877"),u=Object(d["a"])(c,i,n,!1,null,"7ce6d33a",null),m=u.exports,p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.successMsg?s("div",{staticClass:"alert alert-success"},[t._v(t._s(t.successMsg))]):t._e(),t._l(t.errorMsg,(function(e){return s("div",{staticClass:"alert alert-danger"},[t._v(t._s(e))])}))],2)},v=[],f={name:"info",computed:{successMsg:function(){return this.$store.state.success_msg},errorMsg:function(){return this.$store.state.error_msg}}},h=f,g=Object(d["a"])(h,p,v,!1,null,"05817bbb",null),b=g.exports,_={name:"App",provide:function(){return{reload:this.reload}},data:function(){return{isRouterAlive:!0}},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))}},components:{Info:b,navBar:m}},C=_,w=(s("5c0b"),Object(d["a"])(C,o,r,!1,null,null,null)),y=w.exports,x=s("8c4f"),k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("section",{staticClass:"todoapp"},[s("header",{staticClass:"header"},[s("h1",[t._v("todos")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newTodo,expression:"newTodo"}],staticClass:"new-todo",attrs:{autofocus:"",autocomplete:"off",placeholder:"What needs to be done?"},domProps:{value:t.newTodo},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addTodo(e)},input:function(e){e.target.composing||(t.newTodo=e.target.value)}}})]),s("section",{directives:[{name:"show",rawName:"v-show",value:t.todos.length,expression:"todos.length"}],staticClass:"main"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.allDone,expression:"allDone"}],staticClass:"toggle-all",attrs:{id:"toggle-all",type:"checkbox"},domProps:{checked:Array.isArray(t.allDone)?t._i(t.allDone,null)>-1:t.allDone},on:{change:function(e){var s=t.allDone,a=e.target,o=!!a.checked;if(Array.isArray(s)){var r=null,i=t._i(s,r);a.checked?i<0&&(t.allDone=s.concat([r])):i>-1&&(t.allDone=s.slice(0,i).concat(s.slice(i+1)))}else t.allDone=o}}}),s("label",{attrs:{for:"toggle-all"}}),s("ul",{staticClass:"todo-list"},t._l(t.filteredTodos,(function(e){return s("li",{key:e.id,staticClass:"todo",class:{completed:e.completed,editing:e==t.editedTodo}},[s("div",{staticClass:"view"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.completed,expression:"todo.completed"}],staticClass:"toggle",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.completed)?t._i(e.completed,null)>-1:e.completed},on:{change:function(s){var a=e.completed,o=s.target,r=!!o.checked;if(Array.isArray(a)){var i=null,n=t._i(a,i);o.checked?n<0&&t.$set(e,"completed",a.concat([i])):n>-1&&t.$set(e,"completed",a.slice(0,n).concat(a.slice(n+1)))}else t.$set(e,"completed",r)}}}),s("label",{on:{dblclick:function(s){return t.editTodo(e)}}},[t._v(t._s(e.title))]),s("button",{staticClass:"destroy",on:{click:function(s){return t.removeTodo(e)}}})]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"todo.title"},{name:"todo-focus",rawName:"v-todo-focus",value:e==t.editedTodo,expression:"todo == editedTodo"}],staticClass:"edit",attrs:{type:"text"},domProps:{value:e.title},on:{blur:function(s){return t.doneEdit(e)},keyup:[function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.doneEdit(e)},function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"esc",27,s.key,["Esc","Escape"])?null:t.cancelEdit(e)}],input:function(s){s.target.composing||t.$set(e,"title",s.target.value)}}})])})),0)]),s("footer",{directives:[{name:"show",rawName:"v-show",value:t.todos.length,expression:"todos.length"}],staticClass:"footer"},[s("span",{staticClass:"todo-count"},[s("strong",[t._v(t._s(t.remaining))]),t._v(" "+t._s(t._f("pluralize")(t.remaining))+" left\n      ")]),s("ul",{staticClass:"filters"},[s("li",[s("a",{class:{selected:"all"==t.visibility},attrs:{href:"#/all"},on:{click:function(e){t.visibility="all"}}},[t._v("All")])]),s("li",[s("a",{class:{selected:"active"==t.visibility},attrs:{href:"#/active"},on:{click:function(e){t.visibility="active"}}},[t._v("Active")])]),s("li",[s("a",{class:{selected:"completed"==t.visibility},attrs:{href:"#/completed"},on:{click:function(e){t.visibility="completed"}}},[t._v("Completed")])])]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.todos.length>t.remaining,expression:"todos.length > remaining"}],staticClass:"clear-completed",on:{click:t.removeCompleted}},[t._v("\n        Clear completed\n      ")])])]),t._m(0)])},$=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("footer",{staticClass:"info"},[s("p",[t._v("Double-click to edit a todo")]),s("p",[t._v("Written by "),s("a",{attrs:{href:"http://evanyou.me"}},[t._v("Evan You")])]),s("p",[t._v("Part of "),s("a",{attrs:{href:"http://todomvc.com"}},[t._v("TodoMVC")])])])}],N=(s("a481"),s("ac6a"),{all:function(t){return t},active:function(t){return t.filter((function(t){return!t.completed}))},completed:function(t){return t.filter((function(t){return t.completed}))}}),T={name:"todoapp",data:function(){return{todos:[],newTodo:"",editedTodo:null,visibility:"all",uid:0,userId:""}},watch:{todos:{handler:function(t){var e=JSON.stringify(t);this.axios.post("/api/saveTodos",{data:e,userId:this.userId}).then((function(t){console.log("saved successful")}))},deep:!0}},computed:{filteredTodos:function(){return N[this.visibility](this.todos)},remaining:function(){return N.active(this.todos).length},allDone:{get:function(){return 0===this.remaining},set:function(t){this.todos.forEach((function(e){e.completed=t}))}}},filters:{pluralize:function(t){return 1===t?"item":"items"}},mounted:function(){var t=this,e=window.location.hash.replace(/#\/?/,"");N[e]&&(this.visibility=e),this.userId=this.$store.state.userId,this.axios.get("/api/getTodos",{params:{userId:this.$store.state.userId}}).then((function(e){200===e.status&&(e.data.length>0&&(t.todos=JSON.parse(e.data[0].data)),t.uid=t.todos.length)}))},methods:{addTodo:function(){var t=this.newTodo&&this.newTodo.trim();t&&(this.todos.push({id:this.id++,title:t,completed:!1}),this.newTodo="")},removeTodo:function(t){this.todos.splice(this.todos.indexOf(t),1)},editTodo:function(t){this.beforeEditCache=t.title,this.editedTodo=t},doneEdit:function(t){this.editedTodo&&(this.editedTodo=null,t.title=t.title.trim(),t.title||this.removeTodo(t))},cancelEdit:function(t){this.editedTodo=null,t.title=this.beforeEditCache},removeCompleted:function(){this.todos=N.active(this.todos)}},directives:{"todo-focus":function(t,e){e.value&&t.focus()}}},O=T,I=O,S=(s("cccb"),Object(d["a"])(I,k,$,!1,null,null,null)),E=S.exports,P=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},j=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about"},[s("div",{staticClass:"jumbotron text-center"},[s("h1",{staticClass:"display-8"},[t._v("TodoMVC Demo"),s("h1",[s("p",{staticClass:"lead"},[t._v("这是一个TodoMVC 的案例，使用vue+node+mongodb部署到heroku")])])])])])}],M={},A=Object(d["a"])(M,P,j,!1,null,null,null),D=A.exports,J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6 mx-auto"},[s("div",{staticClass:"card card-body"},[t._m(0),s("h3",{staticClass:"text-center"},[t._v("登陆")]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("邮箱")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"email",required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[t._v("密码")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",name:"password",id:"password",required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.login()}}},[t._v("登陆")])])])])])},L=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-center"},[a("img",{staticClass:"logo",attrs:{src:s("cf05")}})])}],q={name:"login",data:function(){return{email:"",password:"",userId:this.$store.state.userId}},mounted:function(){},methods:{login:function(){var t=this;this.email||this.$store.state.error_msg.push("请输入邮箱"),this.password||this.$store.state.error_msg.push("请输入密码"),this.email&&this.password&&this.axios.post("/api/users/login",{email:this.email,password:this.password}).then((function(e){if(t.$store.state.success_msg="",t.$store.state.error_msg=[],200===e.status)if("登陆成功"===e.data.msg)if(t.$store.state.success_msg="登陆成功",t.$store.state.loginState=e.data.loginState,sessionStorage.setItem("userInfo",JSON.stringify(e.data.userId)),sessionStorage.setItem("userName",JSON.stringify(e.data.userName)),t.$store.state.userId=JSON.parse(sessionStorage.getItem("userInfo")),t.$store.state.userName=JSON.parse(sessionStorage.getItem("userName")),t.$route.query.redirect){var s=t.$route.query.redirect;t.$router.push(s)}else t.$router.push("/");else t.$store.state.error_msg.push(e.data.msg)}))}}},B=q,R=(s("9157"),Object(d["a"])(B,J,L,!1,null,"033aa54b",null)),V=R.exports,z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6 mx-auto"},[s("div",{staticClass:"card card-body"},[t._m(0),s("h3",{staticClass:"text-center"},[t._v("注册")]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v("用户名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",name:"name",id:"name",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("邮箱")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"email",required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password1"}},[t._v("密码")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password1,expression:"password1"}],staticClass:"form-control",attrs:{type:"password",name:"password1",id:"password1",required:""},domProps:{value:t.password1},on:{input:function(e){e.target.composing||(t.password1=e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password2"}},[t._v("确认密码")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password2,expression:"password2"}],staticClass:"form-control",attrs:{type:"password",name:"password2",id:"password2",required:""},domProps:{value:t.password2},on:{input:function(e){e.target.composing||(t.password2=e.target.value)}}})]),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.register()}}},[t._v("注册")])])])]),s("div",{staticClass:"modal fade bs-example-modal-sm",attrs:{id:"modal",tabindex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(1),s("div",{staticClass:"modal-body"},[s("h3",{staticClass:"text-center"},[t._v(t._s(t.error_text))])]),s("div",{staticClass:"modal-footer"},[s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-info",attrs:{"data-dismiss":"modal"},on:{click:function(e){return t.closeModal()}}},[t._v("关闭")])])])])])])])},W=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-center"},[a("img",{staticClass:"logo",attrs:{src:s("cf05")}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal-header"},[s("h4",{staticClass:"modal-title",attrs:{id:"myModalLabel"}},[t._v("温馨提示")]),s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],K=s("ff0e"),Y=K["a"],F=(s("0b6f"),Object(d["a"])(Y,z,W,!1,null,"73c60912",null)),G=F.exports,H=s("2f62");a["a"].use(H["a"]);var Q=new H["a"].Store({state:{success_msg:"",error_msg:[],loginState:!1,userInfo:null,userId:JSON.parse(sessionStorage.getItem("userInfo")),userName:JSON.parse(sessionStorage.getItem("userName"))},mutations:{},actions:{}});a["a"].use(x["a"]);var U=new x["a"]({mode:"history",base:"/",routes:[{path:"/",component:E,meta:{needLogin:!0}},{path:"/about",component:D},{path:"/navBar",component:m},{path:"/info",component:b},{path:"/users/login",component:V},{path:"/users/register",component:G}]});U.beforeEach((function(t,e,s){t.meta.needLogin?Q.state.userId?s():s({path:"/users/login",query:{redirect:t.fullPath}}):s()}));var X=U,Z=(s("4989"),s("f9e3"),s("bc3a")),tt=s.n(Z);s("3e48"),s("ab8b");a["a"].prototype.axios=tt.a,a["a"].config.productionTip=!1,new a["a"]({router:X,store:Q,render:function(t){return t(y)}}).$mount("#app")},"5c0b":function(t,e,s){"use strict";var a=s("e332"),o=s.n(a);o.a},9157:function(t,e,s){"use strict";var a=s("f738"),o=s.n(a);o.a},cccb:function(t,e,s){"use strict";var a=s("d563"),o=s.n(a);o.a},cf05:function(t,e,s){t.exports=s.p+"img/logo.82b9c7a5.png"},d563:function(t,e,s){},e332:function(t,e,s){},f738:function(t,e,s){},ff0e:function(t,e,s){"use strict";(function(t){s("7f7f");e["a"]={name:"regiter",data:function(){return{name:"",email:"",password1:"",password2:"",error_text:""}},methods:{register:function(){if(this.password1!==this.password2)return this.$store.state.error_msg.push("密码不一致"),!1;var e=this;this.axios.post("/api/users/register",{userName:this.name,email:this.email,password:this.password1}).then((function(s){console.log(s),""!==s.data&&(t("#modal").modal("show"),e.error_text=s.data.msg)}))},closeModal:function(){this.error_text.indexOf("注册成功")>=0&&this.$router.push("/users/login")}}}}).call(this,s("1157"))}});
//# sourceMappingURL=app.b7c3cdfb.js.map